<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Pray</title>
    <link rel="manifest" href="manifest.json" />
    <meta name="theme-color" content="#0f172a" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body class="bg-[#0f172a] text-white overflow-hidden">
    <!-- Sending Request Loading Overlay -->
    <div
      id="request-sending-overlay"
      class="fixed inset-0 z-[150] bg-[#0f172a]/95 backdrop-blur-xl hidden flex flex-col items-center justify-center"
    >
      <img
        src="assets/pray.png"
        class="w-16 h-16 object-contain animate-loader-breathe"
      />
      <p
        class="text-[10px] font-black uppercase tracking-[0.4em] text-blue-400 mt-6 animate-pulse"
      >
        Lifting up...
      </p>
    </div>

    <!-- Fire Finish Overlay -->
    <div
      id="fire-transition"
      class="fixed inset-0 z-[110] pointer-events-none opacity-0 transition-opacity duration-300"
    ></div>

    <!-- Intro Loading Screen -->
    <div
      id="intro-screen"
      class="fixed inset-0 z-[100] bg-[#0f172a] flex flex-col items-center justify-center transition-opacity duration-500"
    >
      <div class="relative w-24 h-24 mb-4 flex items-center justify-center">
        <img
          src="assets/pray.png"
          class="w-16 h-16 object-contain animate-loader-breathe"
        />
      </div>
    </div>

    <!-- Main App Container -->
    <main
      id="app-content"
      class="h-screen flex flex-col opacity-0 transition-opacity duration-700"
    >
      <header class="p-6 flex justify-between items-center shrink-0 z-10">
        <div
          class="flex items-center gap-2 bg-white/5 px-4 py-2 rounded-full border border-white/10"
        >
          <img src="assets/fire.png" class="w-5 h-5 object-contain" />
          <span id="streak-count" class="font-bold">0</span>
        </div>
        <button
          id="open-requests"
          class="px-5 py-2 rounded-full bg-white/5 flex items-center gap-2 border border-white/10 active:scale-95 transition-all"
        >
          <span
            class="text-xs font-bold uppercase tracking-widest text-blue-400"
            >Prayer Requests</span
          >
        </button>
      </header>

      <!-- Landing Page View -->
      <section
        id="view-landing"
        class="flex-1 overflow-y-auto custom-scrollbar"
      >
        <div
          class="min-h-full flex flex-col items-center justify-center p-6 text-center"
        >
          <div class="mb-6 intro-animation shrink-0">
            <img
              src="assets/pray.png"
              class="w-24 h-24 mx-auto object-contain drop-shadow-[0_0_15px_rgba(59,130,246,0.3)]"
            />
          </div>

          <h2 class="text-4xl font-bold mb-1">Welcome Back</h2>
          <div class="mb-4">
            <p class="text-slate-400 italic text-sm">
              "Be still, and know that I am God."
            </p>
            <p
              class="text-slate-500 text-[10px] uppercase tracking-widest mt-1 font-bold"
            >
              Psalm 46:10
            </p>
          </div>
          <p
            id="last-pray-info"
            class="text-xs text-blue-400/60 mb-8 uppercase tracking-tighter font-bold"
          ></p>

          <button
            id="start-acts"
            class="group relative px-12 py-4 bg-white text-[#0f172a] rounded-full font-bold text-lg overflow-hidden transition-all hover:scale-105 active:scale-95 shrink-0 shadow-xl shadow-blue-500/10"
          >
            <span class="relative z-10">START PRAYING</span>
            <div
              class="absolute inset-0 bg-blue-400 translate-y-full group-hover:translate-y-0 transition-transform duration-300"
            ></div>
          </button>

          <div class="mt-12 w-full max-w-sm pb-10">
            <h3
              class="text-left text-xs uppercase tracking-widest text-slate-500 mb-4 px-2"
            >
              Active Requests
            </h3>
            <div id="landing-requests-preview" class="space-y-3"></div>
          </div>
        </div>
      </section>

      <!-- Prayer Swiper View -->
      <section
        id="view-prayer"
        class="hidden fixed inset-0 z-40 bg-[#0f172a] flex flex-col"
      >
        <button
          id="abort-prayer"
          class="absolute top-6 right-6 z-[60] w-10 h-10 rounded-full bg-black/20 backdrop-blur-md flex items-center justify-center border border-white/10"
        >
          <i class="material-icons text-white">close</i>
        </button>
        <div class="prayer-engine flex-1">
          <div class="swiper" id="swiper"></div>
        </div>
        <div class="p-8 text-center shrink-0 flex flex-col items-center gap-4">
          <button
            id="exit-prayer"
            class="text-slate-500 uppercase tracking-widest text-xs hover:text-white transition-colors"
          >
            End Session
          </button>
        </div>
      </section>
    </main>

    <!-- Modal: Prayer Management -->
    <div
      id="modal-requests"
      class="fixed inset-0 z-50 bg-black/80 backdrop-blur-sm hidden flex items-end sm:items-center justify-center"
    >
      <div
        class="bg-[#1e293b] w-full max-w-xl rounded-t-3xl sm:rounded-3xl h-[92vh] flex flex-col overflow-hidden"
      >
        <div
          class="p-6 flex justify-between items-center border-b border-white/5 shrink-0 bg-[#1e293b] z-20"
        >
          <h2 class="text-xl font-bold">Prayer Requests</h2>
          <button id="close-requests" class="material-icons">close</button>
        </div>

        <div
          class="flex-1 overflow-y-auto p-4 space-y-6 bg-[#161e2d] custom-scrollbar relative"
        >
          <div
            class="sticky top-[-16px] z-10 pt-4 pb-2 bg-[#161e2d] shadow-[0_10px_10px_-5px_#161e2d]"
          >
            <div class="flex gap-4 border-b border-white/5 px-2">
              <button
                id="tab-active"
                class="text-blue-400 border-b-2 border-blue-400 pb-2 px-2 transition-all font-bold"
              >
                Active
              </button>
              <button
                id="tab-answered"
                class="text-slate-500 pb-2 px-2 transition-all"
              >
                Answered
              </button>
            </div>
          </div>

          <div id="requests-list" class="space-y-3 pb-32"></div>
        </div>

        <div class="p-6 bg-[#0f172a] border-t border-white/5 shrink-0 z-20">
          <div id="checklist-builder" class="mb-3 space-y-2 hidden">
            <p class="text-[10px] uppercase font-bold text-slate-500 ml-1">
              New Checklist
            </p>
            <div
              id="checklist-items-preview"
              class="flex flex-wrap gap-2"
            ></div>
          </div>
          <div class="flex gap-2">
            <div class="relative flex-1">
              <input
                type="text"
                id="new-request-input"
                placeholder="What are we praying for?"
                class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 focus:outline-none focus:border-blue-500 pr-24 text-sm"
              />
              <div
                class="absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-1"
              >
                <button
                  id="btn-add-check"
                  title="Add checklist item"
                  class="p-1.5 text-slate-400 hover:text-blue-400"
                >
                  <i class="material-icons text-xl">playlist_add</i>
                </button>
                <label
                  for="image-upload"
                  class="p-1.5 cursor-pointer text-slate-400 hover:text-white"
                  ><i class="material-icons text-xl">add_a_photo</i></label
                >
              </div>
              <input
                type="file"
                id="image-upload"
                class="hidden"
                accept="image/*"
              />
            </div>
            <button
              id="add-request-btn"
              class="bg-blue-600 px-4 rounded-xl flex items-center justify-center active:scale-95 transition-transform"
            >
              <i class="material-icons text-white">send</i>
            </button>
          </div>
          <div id="upload-preview" class="mt-2 hidden">
            <div class="relative inline-block">
              <img
                src=""
                id="preview-img"
                class="h-12 w-12 rounded object-cover border border-white/20"
              />
              <button
                id="clear-upload"
                class="absolute -top-2 -right-2 bg-red-500 rounded-full w-4 h-4 flex items-center justify-center text-[10px]"
              >
                Ã—
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- dedicated Checklist Modal -->
    <div
      id="modal-add-checklist"
      class="fixed inset-0 z-[160] bg-black/90 backdrop-blur-md hidden flex items-center justify-center p-6"
    >
      <div
        class="bg-[#1e293b] w-full max-w-xs rounded-3xl p-6 shadow-2xl border border-white/5"
      >
        <h3
          class="text-lg font-bold mb-4 flex items-center gap-2 text-blue-400"
        >
          <i class="material-icons">playlist_add</i> Add Item
        </h3>
        <input
          type="text"
          id="checklist-item-input"
          placeholder="E.g. Peace, Guidance..."
          class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 focus:outline-none focus:border-blue-500 mb-6 text-sm"
        />
        <div class="flex flex-col gap-2">
          <button
            id="btn-save-checklist-item"
            class="bg-blue-600 text-white py-3 rounded-2xl font-black uppercase text-xs tracking-widest active:scale-95 transition-transform"
          >
            Add to Prayer
          </button>
          <button
            id="btn-cancel-checklist"
            class="bg-white/5 py-3 rounded-2xl text-slate-400 text-xs font-bold"
          >
            Cancel
          </button>
        </div>
      </div>
    </div>

    <!-- Modals (Confirm, Stop, Viewer) -->
    <div
      id="modal-confirm"
      class="fixed inset-0 z-[100] bg-black/90 backdrop-blur-md hidden flex items-center justify-center p-6"
    >
      <div
        class="bg-[#1e293b] w-full max-w-xs rounded-3xl p-8 text-center shadow-2xl border border-white/5"
      >
        <i class="material-icons text-red-500 text-5xl mb-4">delete_outline</i>
        <h3 class="text-xl font-bold mb-2">Delete Record?</h3>
        <p class="text-slate-400 mb-8 text-sm">This action cannot be undone.</p>
        <div class="flex flex-col gap-3">
          <button
            id="confirm-yes"
            class="bg-red-500 text-white py-3 rounded-2xl font-bold active:scale-95 transition-transform"
          >
            Delete Forever
          </button>
          <button
            id="confirm-no"
            class="bg-white/5 py-3 rounded-2xl text-slate-400"
          >
            Cancel
          </button>
        </div>
      </div>
    </div>

    <div
      id="modal-stop-prayer"
      class="fixed inset-0 z-[100] bg-black/90 backdrop-blur-md hidden flex items-center justify-center p-6"
    >
      <div
        class="bg-[#1e293b] w-full max-w-xs rounded-3xl p-8 text-center shadow-2xl border border-white/5"
      >
        <i class="material-icons text-blue-500 text-5xl mb-4"
          >pause_circle_outline</i
        >
        <h3 class="text-xl font-bold mb-2">Stop Praying?</h3>
        <p class="text-slate-400 mb-8 text-sm">
          Progress for this session won't be counted in your streak.
        </p>
        <div class="flex flex-col gap-3">
          <button
            id="stop-yes"
            class="bg-blue-600 text-white py-3 rounded-2xl font-bold active:scale-95 transition-transform"
          >
            Stop Now
          </button>
          <button
            id="stop-no"
            class="bg-white/5 py-3 rounded-2xl text-slate-400"
          >
            Continue
          </button>
        </div>
      </div>
    </div>

    <!-- Redesigned Full Screen Image Viewer Modal -->
    <div
      id="modal-image-viewer"
      class="fixed inset-0 z-[120] bg-black hidden flex flex-col"
    >
      <!-- Status Bar Style Progress -->
      <div class="absolute top-0 left-0 w-full h-1 bg-white/10 z-[140]">
        <div
          id="viewer-progress-bar"
          class="h-full bg-blue-500 w-0 transition-all duration-1000 linear"
        ></div>
      </div>

      <button
        id="close-viewer"
        class="absolute top-6 right-6 z-[140] w-10 h-10 rounded-full bg-black/50 backdrop-blur-md flex items-center justify-center border border-white/10"
      >
        <i class="material-icons text-white">close</i>
      </button>

      <div class="flex-1 flex items-center justify-center p-4">
        <img
          id="viewer-full-img"
          src=""
          class="max-w-full max-h-[85vh] object-contain shadow-2xl"
        />
      </div>
    </div>

    <script type="module" src="app.js"></script>
  </body>
</html>
