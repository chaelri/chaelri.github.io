<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1,viewport-fit=cover"
    />
    <title>WeddingBar — Costs</title>

    <!-- Link CSS -->
    <link rel="stylesheet" href="style.css" />
    <link rel="manifest" href="manifest.json" />
    <link rel="icon" href="icons/icon-192.png" type="image/png" />
    <link rel="apple-touch-icon" href="icons/icon-192.png" />

    <meta name="theme-color" content="#071025" />
  </head>
  <body>
    <main class="app">
      <header class="app-header">
        <div class="hdr-left">
          <h1 class="app-title">
            Wedding Costs<span
              id="nextStepsBtn"
              style="
                font-size: 18px;
                color: #5ec293;
                cursor: pointer;
                margin-left: 12px;
              "
              >Next Steps</span
            >
          </h1>
        </div>

        <div class="hdr-right">
          <h1 class="app-title toggle-controls" id="toggleControlsBtn">
            Add Costs
            <span class="toggle-arrow">▲</span>
          </h1>
        </div>
      </header>
      <section
        id="nextStepsPanel"
        class="card"
        style="display: none; padding: 16px; margin-top: 36px"
      >
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
          "
        >
          <h2 style="margin: 0">Next Steps</h2>
          <button
            id="nextStepsBackBtn"
            style="
              padding: 6px 12px;
              background: rgba(255, 255, 255, 0.05);
              color: white;
              border: none;
              border-radius: 8px;
              cursor: pointer;
            "
          >
            Back
          </button>
        </div>

        <div id="nextStepsList" style="margin-top: 20px">
          <!-- tasks injected here -->
        </div>
      </section>

      <!-- BOTTOM ADD STEP BAR (GLOBAL, OUTSIDE PANEL) -->
      <div
        id="nextStepsAddBar"
        style="
          display: none;
          position: fixed;
          bottom: 0;
          left: 0;
          width: 100%;
          padding: 14px;
          background: rgba(7, 16, 37, 0.95);
          backdrop-filter: blur(10px);
          box-shadow: 0 -8px 25px rgba(0, 0, 0, 0.45);
          box-sizing: border-box;
          z-index: 9999;
        "
      >
        <div
          id="nextStepsAddInner"
          style="max-width: 900px; margin: 0 auto; width: 100%"
        >
          <input
            id="nextStepInput"
            type="text"
            placeholder="Add next step…"
            style="
              width: 100%;
              padding: 12px;
              margin-bottom: 12px;
              border-radius: 10px;
              border: none;
              background: var(--card);
              color: white;
              font-size: 16px;
            "
          />

          <div style="font-size: 12px; color: var(--muted); margin-bottom: 6px">
            Deadline (optional)
          </div>

          <div class="next-date-wrapper">
            <input id="nextStepDeadline" type="date" class="next-date" />
          </div>

          <button
            id="addNextStepBtn"
            class="btn"
            style="width: 100%; border-radius: 12px"
          >
            Add Step
          </button>
        </div>
      </div>

      <div id="weddingCostsWrapper">
        <section class="controls card" aria-label="Controls">
          <div class="inputs">
            <input id="name" type="text" placeholder="Item (e.g., Caterer)" />
            <input id="paid" type="number" placeholder="Paid (e.g., 5000)" />
            <input id="total" type="number" placeholder="Total (e.g., 30000)" />
            <label class="chk">
              <input id="booked" type="checkbox" />
              <span class="box" aria-hidden="true"></span>
              <span class="chk-label">Booked</span>
            </label>
          </div>
          <div class="actions">
            <button id="addBtn" class="btn">Add / Save</button>
            <button id="clearBtn" class="btn ghost">Clear</button>
          </div>
        </section>

        <!-- Chart container: layout is dynamic via CSS/JS -->
        <section id="summarySection" class="card" style="margin-bottom: 12px">
          <div
            id="summaryProgressWrapper"
            style="
              display: flex;
              justify-content: center;
              align-items: center;
              gap: 18px;
              margin: 10px auto;
            "
          >
            <!-- LEFT: Days Left -->
            <div id="daysLeftBox" style="text-align: center">
              <div
                id="daysLeftNumber"
                style="font-size: 22px; font-weight: 700; color: var(--success)"
              >
                0
              </div>
              <div
                style="
                  font-size: 12px;
                  color: var(--muted);
                  letter-spacing: 0.5px;
                "
              >
                DAYS LEFT
              </div>
            </div>

            <!-- RIGHT: Circle -->
            <div id="progress-bar--container" style="width: 120px">
              <svg viewBox="0 0 100 100">
                <!-- Rotate only the circles, NOT the text -->
                <g transform="rotate(-90 50 50)">
                  <circle
                    stroke="#2a364a"
                    stroke-width="8"
                    cx="50"
                    cy="50"
                    r="40"
                    fill="none"
                  />

                  <circle
                    id="progressCircle"
                    stroke="var(--success)"
                    stroke-width="8"
                    cx="50"
                    cy="50"
                    r="40"
                    fill="none"
                    style="
                      stroke-dasharray: 100;
                      stroke-dashoffset: 100;
                      stroke-linecap: round;
                    "
                  />
                </g>

                <!-- TEXT: do NOT rotate this -->
                <text
                  id="progressText"
                  x="50"
                  y="55"
                  text-anchor="middle"
                  dominant-baseline="middle"
                  fill="var(--success)"
                  font-size="14"
                  font-weight="700"
                >
                  0%
                </text>
              </svg>
            </div>
          </div>

          <div style="display: flex; justify-content: space-between">
            <div>
              <div class="muted" style="font-size: 12px">Total Paid</div>
              <div id="summaryPaid" style="font-size: 18px; font-weight: 700">
                ₱0
              </div>
            </div>
            <select
              id="sortSelect"
              class="inputs"
              style="
                padding: 12px;
                border-radius: 10px;
                background: var(--card);
                color: white;
                border: 0;
                margin-left: auto;
                margin-right: 20px;
              "
            >
              <option value="none">Sort by…</option>

              <!-- Alphabetical -->
              <option value="nameAZ">Alphabetical (A → Z)</option>
              <option value="nameZA">Alphabetical (Z → A)</option>

              <!-- Status -->
              <option value="booked">Booked → Not booked</option>
              <option value="notBooked">Not booked → Booked</option>

              <!-- Paid -->
              <option value="paidLow">Paid: Lowest → Highest</option>
              <option value="paidHigh">Paid: Highest → Lowest</option>

              <!-- Total -->
              <option value="totalLow">Total: Lowest → Highest</option>
              <option value="totalHigh">Total: Highest → Lowest</option>

              <!-- Progress % -->
              <option value="pctLow">Progress: Lowest %</option>
              <option value="pctHigh">Progress: Highest %</option>
            </select>
            <div>
              <div class="muted" style="font-size: 12px">Grand Total</div>
              <div id="summaryTotal" style="font-size: 18px; font-weight: 700">
                ₱0
              </div>
            </div>
          </div>
        </section>

        <section id="chartSection" class="chart card" aria-label="Cost chart">
          <div id="bars" class="bars horizontal" role="list" aria-live="polite">
            <!-- Bars injected here by script.js -->
          </div>
        </section>

        <section id="detailPanel" class="detail card" aria-hidden="true">
          <!-- Tapped bar details show here -->
        </section>
      </div>
      <div
        id="uploadLoader"
        style="display: none; margin-top: 10px; text-align: center"
      >
        <div class="loader-spinner"></div>
        <div style="font-size: 12px; margin-top: 6px; color: var(--muted)">
          Uploading…
        </div>
      </div>

      <!-- TABLE VIEW (mobile swipe-right) -->
      <div id="tableViewPanel">
        <div class="table-header">
          <span>Table View</span>
          <button id="closeTableView">×</button>
        </div>

        <div id="tableViewContent"></div>
      </div>

      <!-- ATTACHMENTS GALLERY MODAL -->
      <div id="galleryPanel">
        <div class="gallery-header">
          <span>Attachments Gallery</span>
          <button id="closeGallery">×</button>
        </div>

        <div id="galleryContent"></div>
      </div>
    </main>
    <!-- Fullscreen image preview -->
    <div
      id="imgPreviewOverlay"
      style="
        display: none;
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.85);
        z-index: 100000;
        align-items: center;
        justify-content: center;
      "
    >
      <img
        id="imgPreviewFull"
        src=""
        style="max-width: 90%; max-height: 90%; border-radius: 10px"
      />
    </div>

    <!-- Fullscreen Viewer -->
    <div
      id="imgViewerOverlay"
      style="
        display: none;
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.9);
        z-index: 100000;
        align-items: center;
        justify-content: center;
      "
    >
      <!-- Close Button -->
      <button
        id="viewerCloseBtn"
        style="
          position: absolute;
          top: 20px;
          right: 20px;
          width: 36px;
          height: 36px;
          border-radius: 8px;
          border: none;
          background: rgba(255, 255, 255, 0.2);
          color: white;
          font-size: 20px;
          cursor: pointer;
          z-index: 1;
        "
      >
        ×
      </button>

      <!-- LEFT NAV -->
      <button
        id="viewerPrevBtn"
        style="
          position: absolute;
          right: 70px;
          top: 95%;
          transform: translateY(-50%);
          width: 42px;
          height: 42px;
          border: none;
          border-radius: 12px;
          background: rgba(255, 255, 255, 0.18);
          backdrop-filter: blur(6px);
          color: white;
          font-size: 22px;
          cursor: pointer;
          z-index: 10;
        "
      >
        ‹
      </button>

      <!-- RIGHT NAV -->
      <button
        id="viewerNextBtn"
        style="
          position: absolute;
          right: 20px;
          top: 95%;
          transform: translateY(-50%);
          width: 42px;
          height: 42px;
          border: none;
          border-radius: 12px;
          background: rgba(255, 255, 255, 0.18);
          backdrop-filter: blur(6px);
          color: white;
          font-size: 22px;
          cursor: pointer;
          z-index: 10;
        "
      >
        ›
      </button>

      <img
        id="imgViewerFull"
        style="
          max-width: 90%;
          max-height: 90%;
          border-radius: 10px;
          transition: transform 0.2s;
        "
      />
    </div>

    <!-- Delete Confirmation -->
    <div
      id="confirmDeleteOverlay"
      style="
        display: none;
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: 10000;
        align-items: center;
        justify-content: center;
      "
    >
      <div
        style="
          background: #0b152b;
          padding: 20px;
          border-radius: 10px;
          width: 260px;
          text-align: center;
        "
      >
        <div style="margin-bottom: 12px">
          Are you sure you want to delete this image?
        </div>
        <div style="display: flex; gap: 10px; justify-content: center">
          <button id="confirmDeleteYes" class="btn">Delete</button>
          <button id="confirmDeleteNo" class="btn ghost">Cancel</button>
        </div>
      </div>
    </div>

    <div
      id="saveToast"
      style="
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 10px 14px;
        background: rgb(21 38 53);
        border-radius: 12px;
        color: #70e6a9;
        font-weight: 700;
        backdrop-filter: blur(6px);
        display: none;
        z-index: 9999;
        font-size: 15px;
      "
    >
      ✓ Saved!
    </div>

    <!-- Use module imports in script.js -->
    <script type="module" src="script.js"></script>
  </body>
</html>
